"use strict";var _icons={close:'<svg class="gitment-close-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 50 50"><path d="M37.304 11.282l1.414 1.414-26.022 26.02-1.414-1.413z"/><path d="M12.696 11.282l26.022 26.02-1.414 1.415-26.022-26.02z"/></svg>',github:'<svg class="gitment-github-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 50 50"><path d="M25 10c-8.3 0-15 6.7-15 15 0 6.6 4.3 12.2 10.3 14.2.8.1 1-.3 1-.7v-2.6c-4.2.9-5.1-2-5.1-2-.7-1.7-1.7-2.2-1.7-2.2-1.4-.9.1-.9.1-.9 1.5.1 2.3 1.5 2.3 1.5 1.3 2.3 3.5 1.6 4.4 1.2.1-1 .5-1.6 1-2-3.3-.4-6.8-1.7-6.8-7.4 0-1.6.6-3 1.5-4-.2-.4-.7-1.9.1-4 0 0 1.3-.4 4.1 1.5 1.2-.3 2.5-.5 3.8-.5 1.3 0 2.6.2 3.8.5 2.9-1.9 4.1-1.5 4.1-1.5.8 2.1.3 3.6.1 4 1 1 1.5 2.4 1.5 4 0 5.8-3.5 7-6.8 7.4.5.5 1 1.4 1 2.8v4.1c0 .4.3.9 1 .7 6-2 10.2-7.6 10.2-14.2C40 16.7 33.3 10 25 10z"/></svg>',heart:'<svg class="gitment-heart-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 50 50"><path d="M25 39.7l-.6-.5C11.5 28.7 8 25 8 19c0-5 4-9 9-9 4.1 0 6.4 2.3 8 4.1 1.6-1.8 3.9-4.1 8-4.1 5 0 9 4 9 9 0 6-3.5 9.7-16.4 20.2l-.6.5zM17 12c-3.9 0-7 3.1-7 7 0 5.1 3.2 8.5 15 18.1 11.8-9.6 15-13 15-18.1 0-3.9-3.1-7-7-7-3.5 0-5.4 2.1-6.9 3.8L25 17.1l-1.1-1.3C22.4 14.1 20.5 12 17 12z"/></svg>',spinner:'<svg class="gitment-spinner-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 50 50"><path d="M25 18c-.6 0-1-.4-1-1V9c0-.6.4-1 1-1s1 .4 1 1v8c0 .6-.4 1-1 1z"/><path opacity=".3" d="M25 42c-.6 0-1-.4-1-1v-8c0-.6.4-1 1-1s1 .4 1 1v8c0 .6-.4 1-1 1z"/><path opacity=".3" d="M29 19c-.2 0-.3 0-.5-.1-.4-.3-.6-.8-.3-1.3l4-6.9c.3-.4.8-.6 1.3-.3.4.3.6.8.3 1.3l-4 6.9c-.2.2-.5.4-.8.4z"/><path opacity=".3" d="M17 39.8c-.2 0-.3 0-.5-.1-.4-.3-.6-.8-.3-1.3l4-6.9c.3-.4.8-.6 1.3-.3.4.3.6.8.3 1.3l-4 6.9c-.2.2-.5.4-.8.4z"/><path opacity=".93" d="M21 19c-.3 0-.6-.2-.8-.5l-4-6.9c-.3-.4-.1-1 .3-1.3.4-.3 1-.1 1.3.3l4 6.9c.3.4.1 1-.3 1.3-.2.2-.3.2-.5.2z"/><path opacity=".3" d="M33 39.8c-.3 0-.6-.2-.8-.5l-4-6.9c-.3-.4-.1-1 .3-1.3.4-.3 1-.1 1.3.3l4 6.9c.3.4.1 1-.3 1.3-.2.1-.3.2-.5.2z"/><path opacity=".65" d="M17 26H9c-.6 0-1-.4-1-1s.4-1 1-1h8c.6 0 1 .4 1 1s-.4 1-1 1z"/><path opacity=".3" d="M41 26h-8c-.6 0-1-.4-1-1s.4-1 1-1h8c.6 0 1 .4 1 1s-.4 1-1 1z"/><path opacity=".86" d="M18.1 21.9c-.2 0-.3 0-.5-.1l-6.9-4c-.4-.3-.6-.8-.3-1.3.3-.4.8-.6 1.3-.3l6.9 4c.4.3.6.8.3 1.3-.2.3-.5.4-.8.4z"/><path opacity=".3" d="M38.9 33.9c-.2 0-.3 0-.5-.1l-6.9-4c-.4-.3-.6-.8-.3-1.3.3-.4.8-.6 1.3-.3l6.9 4c.4.3.6.8.3 1.3-.2.3-.5.4-.8.4z"/><path opacity=".44" d="M11.1 33.9c-.3 0-.6-.2-.8-.5-.3-.4-.1-1 .3-1.3l6.9-4c.4-.3 1-.1 1.3.3.3.4.1 1-.3 1.3l-6.9 4c-.1.2-.3.2-.5.2z"/><path opacity=".3" d="M31.9 21.9c-.3 0-.6-.2-.8-.5-.3-.4-.1-1 .3-1.3l6.9-4c.4-.3 1-.1 1.3.3.3.4.1 1-.3 1.3l-6.9 4c-.2.2-.3.2-.5.2z"/></svg>'},_constants={LS_ACCESS_TOKEN_KEY:"gitment-comments-token",LS_USER_KEY:"gitment-user-info",NOT_INITIALIZED_ERROR:new Error("Comments Not Initialized")},_slicedToArray=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],i=!0,a=!1,r=void 0;try{for(var c,o=e[Symbol.iterator]();!(i=(c=o.next()).done)&&(n.push(c.value),!t||n.length!==t);i=!0);}catch(e){a=!0,r=e}finally{try{!i&&o.return&&o.return()}finally{if(a)throw r}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),myTheme={render:function(e,t){var n=document.createElement("div");return n.lang="zh-CN",n.className="gitment-container gitment-root-container",n.appendChild(t.renderHeader(e,t)),n.appendChild(t.renderEditor(e,t)),n.appendChild(t.renderComments(e,t)),n.appendChild(t.renderFooter(e,t)),n},renderHeader:function(e,t){var n=e.meta,i=e.user,a=e.reactions,r=(e.comments,document.createElement("div"));r.lang="zh-CN",r.className="gitment-container gitment-header-container";var c=document.createElement("span"),o=a.find(function(e){return"heart"===e.content&&e.user.login===i.login});c.className="gitment-header-like-btn",c.innerHTML="\n    "+_icons.heart+"\n    赞\n    "+(n.reactions&&n.reactions.heart?" • <strong>"+n.reactions.heart+"</strong> 个赞":"")+"\n  ",o?(c.classList.add("liked"),c.onclick=function(){return t.unlike()}):(c.classList.remove("liked"),c.onclick=function(){return t.like()}),r.appendChild(c);var l=document.createElement("span");l.innerHTML="\n    "+(n.comments?" • <strong>"+n.comments+"</strong> 条评论":"")+"\n  ",r.appendChild(l);var s=document.createElement("a");return s.className="gitment-header-issue-link",s.href=n.html_url,s.target="_blank",s.innerText="问题页面",r.appendChild(s),void 0!==n.html_url&&i.id?r:document.createElement("div")},renderEditor:function(e,t){var n=e.user,i=e.error,a=document.createElement("div");a.lang="zh-CN",a.className="gitment-container gitment-editor-container";var r=n.login&&!i?"":"disabled",c=n.login?"":"登录发表评论";a.innerHTML="\n      "+(n.login?'<a class="gitment-editor-avatar" href="'+n.html_url+'" target="_blank">\n            <img class="gitment-editor-avatar-img" src="'+n.avatar_url+'"/>\n          </a>':n.isLoggingIn?'<div class="gitment-editor-avatar">'+_icons.spinner+"</div>":'<a class="gitment-editor-avatar" href="'+t.loginLink+'" title="GitHub登陆">\n              '+_icons.github+"\n            </a>")+'\n    </a>\n    <div class="gitment-editor-main">\n      <div class="gitment-editor-header">\n        <nav class="gitment-editor-tabs">\n          <button class="gitment-editor-tab gitment-selected">评论</button>\n          <button class="gitment-editor-tab">预览</button>\n        </nav>\n        <div class="gitment-editor-login">\n          '+(n.login?'<a class="gitment-editor-logout-link">退出</a>':n.isLoggingIn?"登陆中...":'GitHub<a class="gitment-editor-login-link" href="'+t.loginLink+'">登陆</a>')+'\n        </div>\n      </div>\n      <div class="gitment-editor-body">\n        <div class="gitment-editor-write-field">\n          <textarea placeholder="留下你的评论" title="'+c+'" '+r+'></textarea>\n        </div>\n        <div class="gitment-editor-preview-field gitment-hidden">\n          <div class="gitment-editor-preview gitment-markdown"></div>\n        </div>\n      </div>\n    </div>\n    <div class="gitment-editor-footer">\n      <a class="gitment-editor-footer-tip" href="https://guides.github.com/features/mastering-markdown/" target="_blank">\n        样式支持 Markdown\n      </a>\n      <button class="gitment-editor-submit" title="'+c+'" '+r+">评论</button>\n    </div>\n  ",n.login&&(a.querySelector(".gitment-editor-logout-link").onclick=function(){return t.logout()});var o=a.querySelector(".gitment-editor-write-field"),l=a.querySelector(".gitment-editor-preview-field"),s=o.querySelector("textarea");s.oninput=function(){s.style.height="auto";var e=window.getComputedStyle(s,null),t=parseInt(e.height,10),n=s.clientHeight,i=s.scrollHeight;n<i&&(s.style.height=t+i-n+"px")};var m=a.querySelectorAll(".gitment-editor-tab"),d=_slicedToArray(m,2),g=d[0],u=d[1];g.onclick=function(){g.classList.add("gitment-selected"),u.classList.remove("gitment-selected"),o.classList.remove("gitment-hidden"),l.classList.add("gitment-hidden"),s.focus()},u.onclick=function(){u.classList.add("gitment-selected"),g.classList.remove("gitment-selected"),l.classList.remove("gitment-hidden"),o.classList.add("gitment-hidden");var e=l.querySelector(".gitment-editor-preview"),n=s.value.trim();n?(e.innerText="加载预览中……",t.markdown(n).then(function(t){return e.innerHTML=t})):e.innerText="没有预览"};var v=a.querySelector(".gitment-editor-submit");return v.onclick=function(){v.innerText="提交中...",v.setAttribute("disabled",!0),t.post(s.value.trim()).then(function(e){s.value="",s.style.height="auto",v.removeAttribute("disabled"),v.innerText="评论"}).catch(function(e){alert(e),v.removeAttribute("disabled"),v.innerText="评论"})},a},renderComments:function(e,t){var n=e.meta,i=e.comments,a=e.commentReactions,r=e.currentPage,c=e.user,o=e.error,l=document.createElement("div");if(l.lang="zh-CN",l.className="gitment-container gitment-comments-container",o){var s=document.createElement("div");if(s.className="gitment-comments-error",o.message===_constants.NOT_INITIALIZED_ERROR.message&&c.login&&c.login.toLowerCase()===t.owner.toLowerCase()){var m=document.createElement("div"),d=document.createElement("button");d.className="gitment-comments-init-btn",d.onclick=function(){d.setAttribute("disabled",!0),t.init().catch(function(e){d.removeAttribute("disabled"),alert(e)})},d.innerText="请初始化评论框",m.appendChild(d),s.appendChild(m)}else s.innerText="Gitment评论框没有初始化，如果你是第一个评论的请登陆点击初始化按钮";return l.appendChild(s),l}if(void 0===i){var g=document.createElement("div");return g.innerText="载入评论中...",g.className="gitment-comments-loading",l.appendChild(g),l}if(!i.length){var u=document.createElement("div");return u.className="gitment-comments-empty",u.innerText="还没有评论",l.appendChild(u),l}var v=document.createElement("ul");if(v.className="gitment-comments-list",i.forEach(function(e){var n=moment(new Date(e.created_at)).format("MM月DD日 h:mm"),i=moment(new Date(e.updated_at)).format("MM月DD日 h:mm"),r=document.createElement("li");r.className="gitment-comment",r.innerHTML='\n      <a class="gitment-comment-avatar" href="'+e.user.html_url+'" target="_blank">\n        <img class="gitment-comment-avatar-img" src="'+e.user.avatar_url+'"/>\n      </a>\n      <div class="gitment-comment-main">\n        <div class="gitment-comment-header">\n          <a class="gitment-comment-name" href="'+e.user.html_url+'" target="_blank">\n            '+e.user.login+'\n          </a>\n          评论\n          <span title="'+n+'">'+n+"</span>\n          "+(n!==i?' • <span title="评论编辑在 '+i+'">编辑</span>':"")+(c.id?'\n          <div class="gitment-comment-like-btn">'+_icons.heart+" "+(e.reactions.heart||"")+"</div>\n        ":"")+'</div>\n        <div class="gitment-comment-body gitment-markdown">'+e.body_html+"</div>\n      </div>\n    ";var o=r.querySelector(".gitment-comment-like-btn");a[e.id]&&a[e.id].find(function(e){return"heart"===e.content&&e.user.login===c.login})?(o.classList.add("liked"),o.onclick=function(){return t.unlikeAComment(e.id)}):c.id&&(o.classList.remove("liked"),o.onclick=function(){return t.likeAComment(e.id)});var l=document.createElement("img"),s=r.querySelector(".gitment-comment-body");l.className="gitment-hidden",l.src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==",l.onload=function(){s.clientHeight>t.maxCommentHeight&&(s.classList.add("gitment-comment-body-folded"),s.style.maxHeight=t.maxCommentHeight+"px",s.title="单击以展开",s.onclick=function(){s.classList.remove("gitment-comment-body-folded"),s.style.maxHeight="",s.title="",s.onclick=null})},r.appendChild(l),v.appendChild(r)}),l.appendChild(v),n){var h=Math.ceil(n.comments/t.perPage);if(h>1){var p=document.createElement("ul");if(p.className="gitment-comments-pagination",r>1){var f=document.createElement("li");f.className="gitment-comments-page-item",f.innerText="上一页",f.onclick=function(){return t.goto(r-1)},p.appendChild(f)}for(var b=function(e){var n=document.createElement("li");n.className="gitment-comments-page-item",n.innerText=e,n.onclick=function(){return t.goto(e)},r===e&&n.classList.add("gitment-selected"),p.appendChild(n)},y=1;y<=h;y++)b(y);if(r<h){var w=document.createElement("li");w.className="gitment-comments-page-item",w.innerText="下一页",w.onclick=function(){return t.goto(r+1)},p.appendChild(w)}l.appendChild(p)}}return l}};